<div style="text-align: center;"><span class="timer" id="s2" style="font-size: 16px"></span></div>
<script>
function countdown( elementName, minutes, seconds )
{
    var element, endTime, hours, mins, msLeft, time;
    function twoDigits( n )
    {
        return (n <= 9 ? "0" + n : n);
    }
    function updateTimer()
    {
        msLeft = endTime - (+new Date);
        if ( msLeft < 1000 ) {
            element.innerHTML = "Time's Up!";
        } else {
            time = new Date( msLeft );
            hours = time.getUTCHours();
            mins = time.getUTCMinutes();
            element.innerHTML = (hours ? hours + ':' + twoDigits( mins ) : mins) + ':' + twoDigits( time.getUTCSeconds() );
            setTimeout( updateTimer, time.getUTCMilliseconds() + 500 );
        }
    }
    element = document.getElementById( elementName );
    endTime = (+new Date) + 1000 * (60*minutes + seconds) + 500;
    updateTimer();
}
countdown("s2", 0, 4 );//2nd value is the minute, 3rd is the seconds
</script>

<!---------- Header ------------->
<header style="visibility: hidden"></header>

<main>
    <!--------- Vocab card ---------->
    {{^IsSentenceCard}} {{^IsWordAndSentenceCard}} {{^IsClickCard}}
    <div lang="ja" class="front-vocab">{{Expression}}</div>
    {{/IsClickCard}} {{/IsWordAndSentenceCard}} {{/IsSentenceCard}}

    <!------- Sentence card --------->
    {{#IsSentenceCard}}
    <div lang="ja" class="front-sentence">
        {{#SentenceFurigana}} {{kanji:SentenceFurigana}} {{/SentenceFurigana}}
        {{^SentenceFurigana}} {{kanji:Sentence}} {{/SentenceFurigana}}
    </div>
    {{/IsSentenceCard}}

    <!--------- Hint card ----------->
    {{#IsWordAndSentenceCard}}
    <div lang="ja" class="front-vocab">{{Expression}}</div>
    <div id="hint">
        {{#SentenceFurigana}} {{kanji:SentenceFurigana}} {{/SentenceFurigana}}
        {{^SentenceFurigana}} {{kanji:Sentence}} {{/SentenceFurigana}}
    </div>
    {{/IsWordAndSentenceCard}}

    <!-------- Click card ----------->
    {{#IsClickCard}}
    <div id="click" class="tappable">
        <div lang="ja" class="front-vocab">{{Expression}}</div>
    </div>
    {{/IsClickCard}}

    <!-- Hint -->
    {{#Hint}}
    <div id="hint">{{Hint}}</div>
    {{/Hint}}
</main>

<script>
    function ClickCard() {
        const clickElement = document.getElementById('click');

        // Store original content so that we can click back to it
        const originalContent = clickElement.innerHTML;

        // This is what it is going to click to
        const clickedContent = `
            <div lang="ja" class="front-sentence">
            {{#SentenceFurigana}} {{kanji:SentenceFurigana}} {{/SentenceFurigana}}
            {{^SentenceFurigana}} {{kanji:Sentence}} {{/SentenceFurigana}}
            </div>
        `;

        function toggleContent() {
            if (clickElement.innerHTML === originalContent) {
                clickElement.innerHTML = clickedContent;
            } else {
                clickElement.innerHTML = originalContent;
            }
        }
        // Implement the clicking mechanism
        clickElement.addEventListener('click', (e) => toggleContent());
        document.addEventListener('keydown', (e) => {
            if (event.key === 'c' | event.key === 'C') toggleContent();
        });
    }

    function cleanWord(word = '{{text:kanji:Expression}}') {
        return word.replace(/\[[^\]]*\]|\([^)]*\)|[0-9!@#$%^&*()_+\-='":\\|,.<>/?~～〜\s]+/g, '')
    }

    function autoCopyWord() {
        setTimeout(async () => {
            try {
                await navigator.clipboard.writeText(cleanWord())
            } catch (err) {
                console.error(err)
            }
        }, 0)
    }

    autoCopyWord();

    function initialize() {
        // Check what card type it is
        if (`{{IsClickCard}}`) ClickCard();
    }

    initialize();
</script>
